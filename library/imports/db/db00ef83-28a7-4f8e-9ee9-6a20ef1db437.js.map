{"version":3,"sources":["..\\..\\..\\..\\assets\\Scripts/assets\\Scripts\\Inimigo.js"],"names":["cc","Class","extends","Component","properties","alvo","Node","dano","Float","tempoAtaque","distanciaPerseguir","distanciaAtaque","tempoVagar","direcaoVagar","Vec2","vidaMaxima","_vidaAtual","_cronometroAtaque","_movimentacao","_controleAnimacao","_gameOver","_tempoRestanteParaVagar","onLoad","getComponent","audioMorte","AudioSource","find","node","on","sofrerDano","UP","update","deltaTime","direcaoAlvo","position","sub","distancia","mag","atacar","andar","vagar","direcao","mudaAnimacao","setDirecao","andarPraFrente","emit","Math","random","evento","detail","vidaAtual","morrer","eventoMorte","Event","EventCustom","dispatchEvent","destroy"],"mappings":"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","file":"Inimigo.js","sourceRoot":"..\\..\\..\\..\\assets\\Scripts","sourcesContent":["cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        alvo: cc.Node,\n        dano : cc.Float,\n        tempoAtaque : cc.Float,\n        distanciaPerseguir : cc.Float,\n        distanciaAtaque : cc.Float,\n        tempoVagar : cc.Float,\n        direcaoVagar : cc.Vec2,\n        vidaMaxima : cc.Float,\n        \n        _vidaAtual : cc.Float,\n        _cronometroAtaque : cc.Float,\n        _movimentacao : cc.Component,\n        _controleAnimacao : cc.Component,\n        _gameOver : cc.Node,\n        _tempoRestanteParaVagar : cc.Float,\n        \n\n    },\n\n    onLoad: function () {\n        this._movimentacao = this.getComponent(\"Movimentacao\");\n        this._controleAnimacao = this.getComponent(\"ControleDeAnimacao\");\n        this.audioMorte = this.getComponent(cc.AudioSource);\n\n        this.alvo = cc.find(\"Personagens/Personagem\");\n        this.node.on(\"SofrerDano\", this.sofrerDano, this);\n        this._cronometroAtaque = this.tempoAtaque;\n        this._tempoRestanteParaVagar = this.tempoVagar;\n        this.direcaoVagar = cc.Vec2.UP;\n        \n        this._vidaAtual = this.vidaMaxima;\n    },\n\n    update: function (deltaTime) {\n        this._cronometroAtaque -= deltaTime;\n        this._tempoRestanteParaVagar -= deltaTime;\n        let direcaoAlvo = this.alvo.position.sub(this.node.position);\n        let distancia = direcaoAlvo.mag();\n\n        if(distancia < this.distanciaAtaque && this._cronometroAtaque < 0){\n            this.atacar();\n        }else if(distancia < this.distanciaPerseguir){\n            this.andar(direcaoAlvo);\n        }else{\n            this.vagar();\n        }\n    },\n    andar : function(direcao){\n        this._controleAnimacao.mudaAnimacao(direcao, \"Andar\");\n        this._movimentacao.setDirecao(direcao);\n        this._movimentacao.andarPraFrente();\n    },\n    atacar : function(){\n        this.alvo.emit(\"SofreDano\", {dano : this.dano});\n        this._cronometroAtaque = this.tempoAtaque;\n    },\n    \n    vagar : function(){\n        if(this._tempoRestanteParaVagar < 0){\n            this.direcaoVagar = new cc.Vec2(Math.random()- 0.5,\n                                           Math.random() - 0.5);\n            this._tempoRestanteParaVagar = this.tempoVagar;\n        }\n        this.andar(this.direcaoVagar)\n    },\n    sofrerDano : function(evento){\n        this._vidaAtual -= evento.detail.dano;\n        this.node.emit(\"atualizaVida\", {vidaAtual : this._vidaAtual,\n                                       vidaMaxima : this.vidaMaxima});\n        if(this._vidaAtual < 0){\n            this.morrer();\n        }\n    },\n    morrer : function(){\n    let eventoMorte = new cc.Event.EventCustom(\"ZumbiMorreu\", true);\n    this.node.dispatchEvent(eventoMorte);\n    this.node.destroy();\n\n}\n\n\n\n\n\n\n         });\n"]}